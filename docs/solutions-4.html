<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>5.4 Solutions | lineaRmodels</title>
  <meta name="description" content="This is a web complement to MATH 341 (Linear Models), a first regression course for EPFL mathematicians.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="5.4 Solutions | lineaRmodels />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a web complement to MATH 341 (Linear Models), a first regression course for EPFL mathematicians." />
  <meta name="github-repo" content="lbelzile/lineaRmodels" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5.4 Solutions | lineaRmodels />
  
  <meta name="twitter:description" content="This is a web complement to MATH 341 (Linear Models), a first regression course for EPFL mathematicians." />
  

<meta name="author" content="Léo Belzile">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="two-way-anova-and-irrelevant-hypotheses.html">
<link rel="next" href="hypothesis-testing.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="libs/rglwidgetClass-2/rgl.css" rel="stylesheet" />
<script src="libs/rglwidgetClass-2/rglClass.src.js"></script>
<script src="libs/CanvasMatrix4-2016/CanvasMatrix.src.js"></script>
<script src="libs/rglWebGL-binding-0.100.1/rglWebGL.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Linear Models</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preliminary remarks</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="basics-of-r.html"><a href="basics-of-r.html"><i class="fa fa-check"></i><b>1.1</b> Basics of <strong>R</strong></a><ul>
<li class="chapter" data-level="1.1.1" data-path="basics-of-r.html"><a href="basics-of-r.html#help"><i class="fa fa-check"></i><b>1.1.1</b> Help</a></li>
<li class="chapter" data-level="1.1.2" data-path="basics-of-r.html"><a href="basics-of-r.html#basic-commands"><i class="fa fa-check"></i><b>1.1.2</b> Basic commands</a></li>
<li class="chapter" data-level="1.1.3" data-path="basics-of-r.html"><a href="basics-of-r.html#linear-algebra-in-r"><i class="fa fa-check"></i><b>1.1.3</b> Linear algebra in <strong>R</strong></a></li>
<li class="chapter" data-level="1.1.4" data-path="basics-of-r.html"><a href="basics-of-r.html#packages"><i class="fa fa-check"></i><b>1.1.4</b> Packages</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="week1.html"><a href="week1.html"><i class="fa fa-check"></i><b>1.2</b> Tutorial 1</a><ul>
<li class="chapter" data-level="1.2.1" data-path="week1.html"><a href="week1.html#datasets"><i class="fa fa-check"></i><b>1.2.1</b> Datasets</a></li>
<li class="chapter" data-level="1.2.2" data-path="week1.html"><a href="week1.html#graphics"><i class="fa fa-check"></i><b>1.2.2</b> Graphics</a></li>
<li class="chapter" data-level="1.2.3" data-path="week1.html"><a href="week1.html#projection-matrices"><i class="fa fa-check"></i><b>1.2.3</b> Projection matrices</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>1.3</b> Exercises</a><ul>
<li class="chapter" data-level="1.3.1" data-path="exercises.html"><a href="exercises.html#auto-dataset"><i class="fa fa-check"></i><b>1.3.1</b> Auto dataset</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="solutions.html"><a href="solutions.html"><i class="fa fa-check"></i><b>1.4</b> Solutions</a><ul>
<li class="chapter" data-level="1.4.1" data-path="solutions.html"><a href="solutions.html#exercise-1.4---oblique-projections"><i class="fa fa-check"></i><b>1.4.1</b> Exercise 1.4 - Oblique projections</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="summary-of-week-1.html"><a href="summary-of-week-1.html"><i class="fa fa-check"></i><b>1.5</b> Summary of week 1</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="computational-considerations.html"><a href="computational-considerations.html"><i class="fa fa-check"></i><b>2</b> Computational considerations</a><ul>
<li class="chapter" data-level="2.1" data-path="calculation-of-least-square-estimates.html"><a href="calculation-of-least-square-estimates.html"><i class="fa fa-check"></i><b>2.1</b> Calculation of least square estimates</a><ul>
<li class="chapter" data-level="2.1.1" data-path="calculation-of-least-square-estimates.html"><a href="calculation-of-least-square-estimates.html#interpretation-of-the-coefficients"><i class="fa fa-check"></i><b>2.1.1</b> Interpretation of the coefficients</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="the-lm-function.html"><a href="the-lm-function.html"><i class="fa fa-check"></i><b>2.2</b> The <code>lm</code> function</a><ul>
<li class="chapter" data-level="2.2.1" data-path="the-lm-function.html"><a href="the-lm-function.html#singular-value-decomposition"><i class="fa fa-check"></i><b>2.2.1</b> Singular value decomposition</a></li>
<li class="chapter" data-level="2.2.2" data-path="the-lm-function.html"><a href="the-lm-function.html#qr-decomposition"><i class="fa fa-check"></i><b>2.2.2</b> QR decomposition</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="the-hyperplane-of-fitted-values.html"><a href="the-hyperplane-of-fitted-values.html"><i class="fa fa-check"></i><b>2.3</b> The hyperplane of fitted values</a></li>
<li class="chapter" data-level="2.4" data-path="centered-coefficient-of-determination.html"><a href="centered-coefficient-of-determination.html"><i class="fa fa-check"></i><b>2.4</b> (Centered) coefficient of determination</a></li>
<li class="chapter" data-level="2.5" data-path="summary-of-week-2.html"><a href="summary-of-week-2.html"><i class="fa fa-check"></i><b>2.5</b> Summary of week 2</a></li>
<li class="chapter" data-level="2.6" data-path="solutions-1.html"><a href="solutions-1.html"><i class="fa fa-check"></i><b>2.6</b> Solutions</a><ul>
<li class="chapter" data-level="2.6.1" data-path="solutions-1.html"><a href="solutions-1.html#exercise-3.5---prostate-cancer"><i class="fa fa-check"></i><b>2.6.1</b> Exercise 3.5 - Prostate cancer</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="frischwaughlovell-theorem.html"><a href="frischwaughlovell-theorem.html"><i class="fa fa-check"></i><b>3</b> Frisch–Waugh–Lovell theorem</a><ul>
<li class="chapter" data-level="3.1" data-path="revisiting-the-interpretation-of-the-parameters-of-a-linear-model.html"><a href="revisiting-the-interpretation-of-the-parameters-of-a-linear-model.html"><i class="fa fa-check"></i><b>3.1</b> Revisiting the interpretation of the parameters of a linear model</a></li>
<li class="chapter" data-level="3.2" data-path="factors.html"><a href="factors.html"><i class="fa fa-check"></i><b>3.2</b> Factors</a></li>
<li class="chapter" data-level="3.3" data-path="example-seasonal-effects.html"><a href="example-seasonal-effects.html"><i class="fa fa-check"></i><b>3.3</b> Example: seasonal effects</a></li>
<li class="chapter" data-level="3.4" data-path="solutions-2.html"><a href="solutions-2.html"><i class="fa fa-check"></i><b>3.4</b> Solutions</a><ul>
<li class="chapter" data-level="3.4.1" data-path="solutions-2.html"><a href="solutions-2.html#exercise-4.4"><i class="fa fa-check"></i><b>3.4.1</b> Exercise 4.4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="gaussian-linear-model.html"><a href="gaussian-linear-model.html"><i class="fa fa-check"></i><b>4</b> Gaussian linear model</a><ul>
<li class="chapter" data-level="4.1" data-path="confidence-and-prediction-intervals.html"><a href="confidence-and-prediction-intervals.html"><i class="fa fa-check"></i><b>4.1</b> Confidence and prediction intervals</a></li>
<li class="chapter" data-level="4.2" data-path="residuals.html"><a href="residuals.html"><i class="fa fa-check"></i><b>4.2</b> Residuals</a></li>
<li class="chapter" data-level="4.3" data-path="diagnostic-plots.html"><a href="diagnostic-plots.html"><i class="fa fa-check"></i><b>4.3</b> Diagnostic plots</a><ul>
<li class="chapter" data-level="4.3.1" data-path="diagnostic-plots.html"><a href="diagnostic-plots.html#added-variable-plots"><i class="fa fa-check"></i><b>4.3.1</b> Added-variable plots</a></li>
<li class="chapter" data-level="4.3.2" data-path="diagnostic-plots.html"><a href="diagnostic-plots.html#diagnostic-of-heteroscedasticity"><i class="fa fa-check"></i><b>4.3.2</b> Diagnostic of heteroscedasticity</a></li>
<li class="chapter" data-level="4.3.3" data-path="diagnostic-plots.html"><a href="diagnostic-plots.html#outliers"><i class="fa fa-check"></i><b>4.3.3</b> Outliers</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="qqplot.html"><a href="qqplot.html"><i class="fa fa-check"></i><b>4.4</b> Quantile-quantile plots</a><ul>
<li class="chapter" data-level="4.4.1" data-path="qqplot.html"><a href="qqplot.html#quantile-quantile-plot-of-externally-studentized-errors"><i class="fa fa-check"></i><b>4.4.1</b> Quantile-quantile plot of externally studentized errors</a></li>
<li class="chapter" data-level="4.4.2" data-path="qqplot.html"><a href="qqplot.html#quantile-quantile-plot-using-the-qr-decomposition"><i class="fa fa-check"></i><b>4.4.2</b> Quantile-quantile plot using the QR decomposition</a></li>
<li class="chapter" data-level="4.4.3" data-path="qqplot.html"><a href="qqplot.html#monte-carlo-methods-for-confidence-intervals"><i class="fa fa-check"></i><b>4.4.3</b> Monte Carlo methods for confidence intervals</a></li>
<li class="chapter" data-level="4.4.4" data-path="qqplot.html"><a href="qqplot.html#parametric-bootstrap-confidence-intervals-using-the-qr-decomposition"><i class="fa fa-check"></i><b>4.4.4</b> Parametric bootstrap confidence intervals using the QR decomposition</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="solutions-3.html"><a href="solutions-3.html"><i class="fa fa-check"></i><b>4.5</b> Solutions</a><ul>
<li class="chapter" data-level="4.5.1" data-path="solutions-3.html"><a href="solutions-3.html#exercise-7.1---study-of-growth-hormones"><i class="fa fa-check"></i><b>4.5.1</b> Exercise 7.1 - Study of growth hormones</a></li>
<li class="chapter" data-level="4.5.2" data-path="solutions-3.html"><a href="solutions-3.html#exercise-7.2---electric-production-of-windmills"><i class="fa fa-check"></i><b>4.5.2</b> Exercise 7.2 - Electric production of windmills</a></li>
<li class="chapter" data-level="4.5.3" data-path="solutions-3.html"><a href="solutions-3.html#exercise-7.3---air-traffic"><i class="fa fa-check"></i><b>4.5.3</b> Exercise 7.3 - Air traffic</a></li>
<li class="chapter" data-level="4.5.4" data-path="solutions-3.html"><a href="solutions-3.html#exercise-7.4---determinants-of-earnings"><i class="fa fa-check"></i><b>4.5.4</b> Exercise 7.4 - Determinants of earnings</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html"><i class="fa fa-check"></i><b>5</b> Analysis of variance</a><ul>
<li class="chapter" data-level="5.1" data-path="sum-of-squares-decomposition.html"><a href="sum-of-squares-decomposition.html"><i class="fa fa-check"></i><b>5.1</b> Sum of squares decomposition</a><ul>
<li class="chapter" data-level="5.1.1" data-path="sum-of-squares-decomposition.html"><a href="sum-of-squares-decomposition.html#the-decomposition-of-squares-in-r"><i class="fa fa-check"></i><b>5.1.1</b> The decomposition of squares in <strong>R</strong></a></li>
<li class="chapter" data-level="5.1.2" data-path="sum-of-squares-decomposition.html"><a href="sum-of-squares-decomposition.html#dropping-or-adding-variables"><i class="fa fa-check"></i><b>5.1.2</b> Dropping or adding variables</a></li>
<li class="chapter" data-level="5.1.3" data-path="sum-of-squares-decomposition.html"><a href="sum-of-squares-decomposition.html#biased-rss"><i class="fa fa-check"></i><b>5.1.3</b> Biased estimators of the residual sum of square</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="one-way-anova.html"><a href="one-way-anova.html"><i class="fa fa-check"></i><b>5.2</b> One-way ANOVA</a></li>
<li class="chapter" data-level="5.3" data-path="two-way-anova-and-irrelevant-hypotheses.html"><a href="two-way-anova-and-irrelevant-hypotheses.html"><i class="fa fa-check"></i><b>5.3</b> Two-way ANOVA and irrelevant hypotheses</a></li>
<li class="chapter" data-level="5.4" data-path="solutions-4.html"><a href="solutions-4.html"><i class="fa fa-check"></i><b>5.4</b> Solutions</a><ul>
<li class="chapter" data-level="5.4.1" data-path="solutions-4.html"><a href="solutions-4.html#exercise-9.3---one-way-analysis-of-variance"><i class="fa fa-check"></i><b>5.4.1</b> Exercise 9.3 - One-way analysis of variance</a></li>
<li class="chapter" data-level="5.4.2" data-path="solutions-4.html"><a href="solutions-4.html#exercise-9.4---two-way-analysis-of-variance"><i class="fa fa-check"></i><b>5.4.2</b> Exercise 9.4 - Two-way analysis of variance</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>6</b> Hypothesis testing</a></li>
<li class="chapter" data-level="7" data-path="model-selection.html"><a href="model-selection.html"><i class="fa fa-check"></i><b>7</b> Model selection</a><ul>
<li class="chapter" data-level="7.1" data-path="example-price-of-diamonds.html"><a href="example-price-of-diamonds.html"><i class="fa fa-check"></i><b>7.1</b> Example: Price of diamonds</a><ul>
<li class="chapter" data-level="7.1.1" data-path="example-price-of-diamonds.html"><a href="example-price-of-diamonds.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>7.1.1</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="7.1.2" data-path="example-price-of-diamonds.html"><a href="example-price-of-diamonds.html#model-selection-1"><i class="fa fa-check"></i><b>7.1.2</b> Model selection</a></li>
<li class="chapter" data-level="7.1.3" data-path="example-price-of-diamonds.html"><a href="example-price-of-diamonds.html#information-criterion"><i class="fa fa-check"></i><b>7.1.3</b> Information criterion</a></li>
<li class="chapter" data-level="7.1.4" data-path="example-price-of-diamonds.html"><a href="example-price-of-diamonds.html#cross-validation"><i class="fa fa-check"></i><b>7.1.4</b> Cross-validation</a></li>
<li class="chapter" data-level="7.1.5" data-path="example-price-of-diamonds.html"><a href="example-price-of-diamonds.html#presentation-of-results"><i class="fa fa-check"></i><b>7.1.5</b> Presentation of results</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="model-selection-invalidates-p-values.html"><a href="model-selection-invalidates-p-values.html"><i class="fa fa-check"></i><b>7.2</b> Model selection invalidates P-values</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="penalized-regression-methods.html"><a href="penalized-regression-methods.html"><i class="fa fa-check"></i><b>8</b> Penalized regression methods</a><ul>
<li class="chapter" data-level="8.1" data-path="bias-and-variance-tradeoff.html"><a href="bias-and-variance-tradeoff.html"><i class="fa fa-check"></i><b>8.1</b> Bias and variance tradeoff</a></li>
<li class="chapter" data-level="8.2" data-path="cross-validation-1.html"><a href="cross-validation-1.html"><i class="fa fa-check"></i><b>8.2</b> Cross-validation</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="splines.html"><a href="splines.html"><i class="fa fa-check"></i><b>9</b> Splines</a><ul>
<li class="chapter" data-level="9.1" data-path="solutions-5.html"><a href="solutions-5.html"><i class="fa fa-check"></i><b>9.1</b> Solutions</a><ul>
<li class="chapter" data-level="9.1.1" data-path="solutions-5.html"><a href="solutions-5.html#exercise-12.4-smoothing-splines"><i class="fa fa-check"></i><b>9.1.1</b> Exercise 12.4 Smoothing splines</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html"><i class="fa fa-check"></i><b>10</b> Generalized linear models</a><ul>
<li class="chapter" data-level="10.1" data-path="diagnostics-for-bernoulli-data.html"><a href="diagnostics-for-bernoulli-data.html"><i class="fa fa-check"></i><b>10.1</b> Diagnostics for Bernoulli data</a></li>
<li class="chapter" data-level="10.2" data-path="poisson-model-for-contingency-table.html"><a href="poisson-model-for-contingency-table.html"><i class="fa fa-check"></i><b>10.2</b> Poisson model for contingency table</a></li>
<li class="chapter" data-level="10.3" data-path="solutions-6.html"><a href="solutions-6.html"><i class="fa fa-check"></i><b>10.3</b> Solutions</a><ul>
<li class="chapter" data-level="10.3.1" data-path="solutions-6.html"><a href="solutions-6.html#exercise-13.3---two-way-contingency-tables"><i class="fa fa-check"></i><b>10.3.1</b> Exercise 13.3 - Two-way contingency tables</a></li>
<li class="chapter" data-level="10.3.2" data-path="solutions-6.html"><a href="solutions-6.html#exercise-13.5---equivalence-of-binomial-and-poisson-models"><i class="fa fa-check"></i><b>10.3.2</b> Exercise 13.5 - Equivalence of binomial and Poisson models</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">lineaRmodels</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="solutions-4" class="section level2">
<h2><span class="header-section-number">5.4</span> Solutions</h2>
<div id="exercise-9.3---one-way-analysis-of-variance" class="section level3">
<h3><span class="header-section-number">5.4.1</span> Exercise 9.3 - One-way analysis of variance</h3>
<p>In this example, the three groups have very different variances! We carry out the testing procedure simply to show you how it is done (this does not imply we should use it in practice).</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">options</span>(<span class="dt">show.signif.stars =</span> <span class="ot">FALSE</span>)
<span class="co">#http://www.stat.ufl.edu/~winner/data/meniscus.txt</span>
meniscus &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;http://sma.epfl.ch/~lbelzile/math341/meniscus.dat&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>)
<span class="kw">boxplot</span>(displacement <span class="op">~</span><span class="st"> </span>method, <span class="dt">data =</span> meniscus, <span class="dt">ylab =</span> <span class="st">&quot;Displacement (in mm)&quot;</span>)</code></pre>
<p><img src="LinesRModels_files/figure-html/unnamed-chunk-42-1.png" width="70%" style="display: block; margin: auto;" /></p>
<pre class="sourceCode r"><code class="sourceCode r">lmod_men &lt;-<span class="st"> </span><span class="kw">lm</span>(displacement <span class="op">~</span><span class="st"> </span>method, <span class="dt">data =</span> meniscus)
summ_men &lt;-<span class="st"> </span><span class="kw">summary</span>(lmod_men)
<span class="co">#ANOVA table</span>
anov_men &lt;-<span class="st"> </span><span class="kw">anova</span>(lmod_men)
<span class="co">#F statistic with dof</span>
summ_men<span class="op">$</span>fstatistic</code></pre>
<pre><code>##     value     numdf     dendf 
##  5.783689  2.000000 15.000000</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#P-value</span>
anov_men[<span class="dv">1</span>,<span class="st">&quot;Pr(&gt;F)&quot;</span>]</code></pre>
<pre><code>## [1] 0.01374261</code></pre>
<p>The <span class="math inline">\(F\)</span> statistic for the null hypothesis <span class="math inline">\(\mu_1=\mu_2=\mu_3\)</span> is 5.78 against the alternative that at least one group mean differ. Under the assumption of the Gaussian linear model, <span class="math inline">\(F\)</span> follows a Fisher distribution with 2 and 15 degrees of freedom. The <span class="math inline">\(P\)</span>-value is thus 0.01 and we therefore reject the null hypothesis that the treatment is equal at level <span class="math inline">\(\alpha = 0.05\)</span>.</p>
<p>The <code>meniscus</code> dat set is a balanced design, which implies that the number of observations is the same for each level of the factor. Since the entries of <span class="math inline">\(\mathbf{X}^\top\mathbf{X}\)</span> depend on the counts for each level, they will be the same here. This implies that the standard errors are also identical for each level (except for the baseline, symbolized by the intercept). Removing the latter changes the parametrization from baseline and constrast to individual group mean.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(lmod_men2 &lt;-<span class="st"> </span><span class="kw">lm</span>(displacement <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>method, <span class="dt">data =</span> meniscus))</code></pre>
<pre><code>## 
## Call:
## lm(formula = displacement ~ 0 + method, data = meniscus)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -8.2667 -1.8500  0.2833  1.7708  5.3333 
## 
## Coefficients:
##                       Estimate Std. Error t value      Pr(&gt;|t|)
## methodFasT-Fix          17.467      1.403  12.454 0.00000000260
## methodMeniscus Arrow    11.383      1.403   8.116 0.00000072052
## methodVertical Suture   16.950      1.403  12.085 0.00000000392
## 
## Residual standard error: 3.435 on 15 degrees of freedom
## Multiple R-squared:  0.9607, Adjusted R-squared:  0.9529 
## F-statistic: 122.3 on 3 and 15 DF,  p-value: 0.00000000009081</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">crossprod</span>(<span class="kw">model.matrix</span>(lmod_men2))</code></pre>
<pre><code>##                       methodFasT-Fix methodMeniscus Arrow
## methodFasT-Fix                     6                    0
## methodMeniscus Arrow               0                    6
## methodVertical Suture              0                    0
##                       methodVertical Suture
## methodFasT-Fix                            0
## methodMeniscus Arrow                      0
## methodVertical Suture                     6</code></pre>
<p>Note that the value of the multiple R-squared value is not the same, nor is the <span class="math inline">\(F\)</span>-statistic. The residuals sum of square does not change because the adjustment is the same. However, without an intercept, <strong>R</strong> computes the decomposition
<span class="math inline">\(\boldsymbol{y}^\top\boldsymbol{y} = \mathrm{RSS} + \boldsymbol{y}^\top\mathbf{H}_{\mathbf{X}}\boldsymbol{y}\)</span> rather than <span class="math inline">\(\mathrm{TSS} = \boldsymbol{y}^\top\mathbf{M}_{\mathbf{1}_n}\boldsymbol{y}= \mathrm{ESS}+\mathrm{RSS}\)</span>.
We have <span class="math inline">\(\mathrm{TSS} = \boldsymbol{y}^\top\boldsymbol{y}-n\bar{y}^2\)</span>.</p>
<p>We can compute the mean using the information on the total number of cases, since <span class="math inline">\(\bar{y} = (\hat{\mu}_1+\hat{\mu}_2 + \hat{\mu}_3)/3\)</span>.</p>
</div>
<div id="exercise-9.4---two-way-analysis-of-variance" class="section level3">
<h3><span class="header-section-number">5.4.2</span> Exercise 9.4 - Two-way analysis of variance</h3>
<pre class="sourceCode r"><code class="sourceCode r">diet &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;http://sma.epfl.ch/~lbelzile/math341/diet.dat&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>)
<span class="co">#Cast strings to factors</span>
diet<span class="op">$</span>diet.type &lt;-<span class="st"> </span><span class="kw">as.factor</span>(diet<span class="op">$</span>diet.type)
diet<span class="op">$</span>gender &lt;-<span class="st"> </span><span class="kw">as.factor</span>(diet<span class="op">$</span>gender)

<span class="co">#Check mean and variance by combination of factor</span>
<span class="co">#Warning: small sample sizes</span>
facs &lt;-<span class="st"> </span><span class="kw">list</span>(diet<span class="op">$</span>diet.type, diet<span class="op">$</span>gender)
<span class="kw">tapply</span>(diet<span class="op">$</span>weight.loss, facs, mean)</code></pre>
<pre><code>##      Female      Male
## A -3.050000 -3.650000
## B -2.607143 -4.109091
## C -5.880000 -4.233333</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tapply</span>(diet<span class="op">$</span>weight.loss, facs, var)</code></pre>
<pre><code>##     Female     Male
## A 4.264231 6.431667
## B 5.239176 6.376909
## C 3.570286 7.376970</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Variance may not be homogeneous for men/women </span>
<span class="co">#Fit model with interaction</span>
M5 &lt;-<span class="st"> </span><span class="kw">lm</span>(weight.loss <span class="op">~</span><span class="st"> </span>gender <span class="op">*</span><span class="st"> </span>diet.type, <span class="dt">data =</span> diet)
M4 &lt;-<span class="st"> </span><span class="kw">lm</span>(weight.loss <span class="op">~</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>diet.type, <span class="dt">data =</span> diet)
M3 &lt;-<span class="st"> </span><span class="kw">lm</span>(weight.loss <span class="op">~</span><span class="st"> </span>diet.type, <span class="dt">data =</span> diet)
M2 &lt;-<span class="st"> </span><span class="kw">lm</span>(weight.loss <span class="op">~</span><span class="st"> </span>gender, <span class="dt">data =</span> diet)
M1 &lt;-<span class="st"> </span><span class="kw">lm</span>(weight.loss <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data =</span> diet)
<span class="co">#ANOVA Tables (recall sequential decomposition) - prefered option</span>
<span class="kw">anova</span>(M5)</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Response: weight.loss
##                  Df Sum Sq Mean Sq F value   Pr(&gt;F)
## gender            1   0.28  0.2785  0.0518 0.820623
## diet.type         2  60.42 30.2086  5.6190 0.005456
## gender:diet.type  2  33.90 16.9520  3.1532 0.048842
## Residuals        70 376.33  5.3761</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#anova(M5) uses RSS from M5 in denominator, read table from bottom to top</span>
<span class="co">#RSS values</span>
RSS &lt;-<span class="st"> </span><span class="kw">anova</span>(M1, M2, M3, M4, M5)[,<span class="st">&quot;RSS&quot;</span>]
<span class="co">#Backward model selection (more complex to simpler)</span>
<span class="kw">drop1</span>(M5, <span class="dt">test =</span> <span class="st">&quot;F&quot;</span>)</code></pre>
<pre><code>## Single term deletions
## 
## Model:
## weight.loss ~ gender * diet.type
##                  Df Sum of Sq    RSS    AIC F value  Pr(&gt;F)
## &lt;none&gt;                        376.33 133.58                
## gender:diet.type  2    33.904 410.23 136.13  3.1532 0.04884</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Manual calculation</span>
F45 &lt;-<span class="st"> </span>((RSS[<span class="dv">4</span>]<span class="op">-</span>RSS[<span class="dv">5</span>])<span class="op">/</span><span class="dv">2</span>)<span class="op">/</span>(RSS[<span class="dv">5</span>]<span class="op">/</span>M5<span class="op">$</span>df.residual)</code></pre>
<p>For forward model selection, we select the covariate that is the most correlated with the response first. The residual sum of square of the denominator must be correct, so we could use that of the most complex model here.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(<span class="kw">lm</span>(weight.loss <span class="op">~</span><span class="st"> </span>gender <span class="op">*</span><span class="st"> </span>diet.type, <span class="dt">data =</span> diet))[<span class="st">&quot;gender&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;F value&quot;</span>,<span class="st">&quot;Pr(&gt;F)&quot;</span>)] </code></pre>
<pre><code>##        F value Pr(&gt;F)
## gender  0.0518 0.8206</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#gender is not significant</span>
<span class="kw">anova</span>(<span class="kw">lm</span>(weight.loss <span class="op">~</span><span class="st"> </span>diet.type <span class="op">*</span><span class="st"> </span>gender, <span class="dt">data =</span> diet))[<span class="st">&quot;diet.type&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;F value&quot;</span>,<span class="st">&quot;Pr(&gt;F)&quot;</span>)] </code></pre>
<pre><code>##           F value   Pr(&gt;F)
## diet.type  5.6292 0.005408</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#diet type is significant</span>

<span class="co">#Alternatively - assume that the model is CORRECT</span>
<span class="co">## Clearly not the case</span>
<span class="kw">add1</span>(M1, <span class="dt">scope =</span> <span class="kw">c</span>(<span class="st">&quot;diet.type&quot;</span>,<span class="st">&quot;gender&quot;</span>), <span class="dt">test =</span> <span class="st">&quot;F&quot;</span>)</code></pre>
<pre><code>## Single term additions
## 
## Model:
## weight.loss ~ 1
##           Df Sum of Sq    RSS    AIC F value   Pr(&gt;F)
## &lt;none&gt;                 470.93 140.62                 
## diet.type  2    60.527 410.40 134.17  5.3831 0.006596
## gender     1     0.278 470.65 142.58  0.0438 0.834827</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#manually computing F-test between diet.type + intercept and intercept only</span>
<span class="kw">isTRUE</span>(<span class="kw">all.equal</span>( 
  ((RSS[<span class="dv">1</span>]<span class="op">-</span>RSS[<span class="dv">3</span>])<span class="op">/</span><span class="dv">2</span>)<span class="op">/</span>(RSS[<span class="dv">3</span>]<span class="op">/</span>(<span class="dv">73</span>)), 
  <span class="kw">add1</span>(M1, <span class="dt">scope =</span> <span class="kw">c</span>(<span class="st">&quot;diet.type&quot;</span>,<span class="st">&quot;gender&quot;</span>), <span class="dt">test =</span> <span class="st">&quot;F&quot;</span>)[<span class="st">&quot;diet.type&quot;</span>, <span class="st">&quot;F value&quot;</span>]))</code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Note that in the above, the RSS is that of the more complex model, but not the full model</span>
<span class="kw">add1</span>(M3, <span class="dt">scope =</span> <span class="st">&quot;gender&quot;</span>, <span class="dt">test =</span> <span class="st">&quot;F&quot;</span>)</code></pre>
<pre><code>## Single term additions
## 
## Model:
## weight.loss ~ diet.type
##        Df Sum of Sq    RSS    AIC F value Pr(&gt;F)
## &lt;none&gt;              410.40 134.17               
## gender  1    0.1687 410.23 136.13  0.0296 0.8639</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#No evidence against the simpler null model with only diet</span>
<span class="co">#We do not test for the interaction model without main effects included!</span></code></pre>
<p>We can use information criterion to estimate the goodness-of-fit of the model.
The Akaike’s information criterion (AIC) and Schwartz’ information criterion (BIC) can be obtained by use of the functions <code>AIC</code> and <code>BIC</code>, respectively.</p>
<p>An alternative is Mallow’s <span class="math inline">\(C_p\)</span>, which requires an estimate of <span class="math inline">\(s^2\)</span>. It is customary to select <span class="math inline">\(s^2\)</span> as the mean residual sum of squares from the most complex model, to make the comparisons fair avoid bias to due model misspecification.
The most complex model will by construction give <span class="math inline">\(C_p=p\)</span> (so we cannot assess the goodness-of-fit of this model using this technique). Good models are those for which the value of <span class="math inline">\(C_p\)</span> is close to <span class="math inline">\(p\)</span>.</p>
<pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">lapply</span>(<span class="kw">list</span>(M1, M2, M3, M4, M5), 
                   <span class="dt">FUN =</span> <span class="cf">function</span>(mod){<span class="kw">length</span>(<span class="kw">coef</span>(mod))}))
Mallow_Cp &lt;-<span class="st"> </span>RSS<span class="op">/</span>RSS[<span class="dv">5</span>]<span class="op">*</span>(<span class="kw">nrow</span>(diet)<span class="op">-</span>p[<span class="dv">5</span>]) <span class="op">-</span><span class="st"> </span><span class="kw">nrow</span>(diet) <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>p
Mallow_Cp</code></pre>
<pre><code>## [1] 13.596261 15.544461  6.337787  8.306409  6.000000</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Step function for model selection using AIC/BIC</span>
<span class="co">#step(M5, direction = &#39;backward&#39;,trace = FALSE, k = log(76))</span>

<span class="co">#Alternatively, compute each AIC/BIC value</span>
aic_val &lt;-<span class="st"> </span><span class="kw">AIC</span>(M1, M2, M3, M4, M5)
bic_val &lt;-<span class="st"> </span><span class="kw">BIC</span>(M1, M2, M3, M4, M5)
<span class="kw">which.min</span>(aic_val<span class="op">$</span>AIC)</code></pre>
<pre><code>## [1] 5</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">which.min</span>(bic_val<span class="op">$</span>BIC)</code></pre>
<pre><code>## [1] 3</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Store values in table</span>
ICvals &lt;-<span class="st"> </span><span class="kw">rbind</span>(aic_val<span class="op">$</span>AIC, bic_val<span class="op">$</span>BIC)
<span class="kw">colnames</span>(ICvals) &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;M&quot;</span>, <span class="kw">seq</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>))
<span class="kw">rownames</span>(ICvals) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;AIC&quot;</span>, <span class="st">&quot;BIC&quot;</span>)
<span class="co">#Create table for Markdown</span>
knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">round</span>(ICvals,<span class="dv">2</span>))</code></pre>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">M1</th>
<th align="right">M2</th>
<th align="right">M3</th>
<th align="right">M4</th>
<th align="right">M5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>AIC</td>
<td align="right">358.30</td>
<td align="right">360.26</td>
<td align="right">351.85</td>
<td align="right">353.81</td>
<td align="right">351.26</td>
</tr>
<tr class="even">
<td>BIC</td>
<td align="right">362.96</td>
<td align="right">367.25</td>
<td align="right">361.17</td>
<td align="right">365.47</td>
<td align="right">367.57</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Create table to export in LaTeX</span>
tab &lt;-<span class="st"> </span>xtable<span class="op">::</span><span class="kw">xtable</span>(<span class="kw">round</span>(ICvals,<span class="dv">1</span>), <span class="dt">caption =</span> <span class="st">&quot;Two-way ANOVA, diet data&quot;</span>)
<span class="co">#print(tab, booktabs = TRUE)</span></code></pre>

</div>
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="two-way-anova-and-irrelevant-hypotheses.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="hypothesis-testing.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["LinesRModels.pdf", "LinesRModels.epub"],
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
